"$schema" = "https://jj-vcs.github.io/jj/latest/config-schema.json"

[user]
name = "Ethan Lowman"
email = "git@ethanlowman.com"

[git]
push-bookmark-prefix = "ethan/"

[revsets]
short-prefixes = "(mine() & (mutable() | bookmarks())) | tracked_remote_bookmarks()"

[ui]
# default-command = ["log", "-r", "trunk() | local_trunk() | (mine_flexible() & local_trunk()..)"]
default-command = [
    "log",
    "-r",
    "trunk() | (mine() & mutable()) | (tracked_remote_bookmarks() & ~::trunk())::",
    # "(trunk() | (~::trunk() & ::@ & (~mine() | mutable())) | (mine() & ~::untracked_remote_bookmarks()) & mutable()| tracked_remote_bookmarks())",
    "--no-pager",
    "-T",
    '''
separate(" ",
  format_short_change_id_with_hidden_and_divergent_info(self),
  separate(commit_summary_separator,
    bookmarks.filter(|b| !b.name().starts_with("mq/")),
    if(!self.mine(), self.author().name()),
    separate(" ",
      if(conflict, label("conflict", "(conflict)")),
      if(empty, label("empty", "(empty)")),
      if(description,
        description.first_line(),
        label(if(empty, "empty"), description_placeholder),
      ),
    ),
  ),
  commit_id.short(8),
)
''',
]
diff-editor = ":builtin"
pager = [
    "sh",
    "-c",
    "delta --side-by-side --minus-style 'syntax #500000' --plus-style 'syntax #005000' --file-transformation \"s|^|> $(jj root)/|g\" -w $(tput cols) | less -F",
]

[ui.diff]
format = "git"

[colors]
"node working_copy" = { fg = "magenta", bold = false }
"prefix" = { fg = "bright magenta", bold = true }

[aliases]
push = ["git", "push"]
up = ["edit", "-r", "@+"]
down = ["edit", "-r", "@-"]
sq = ["squash"]
rb = ["rebase"]
cp = ["duplicate"]
ll = ["log", "-r", "::@ | @::"]

[revset-aliases]
"mine_flexible()" = "mine() | author_name('Ethan Lowman')"
# "local_trunk()" = "latest(bookmarks(exact:'trunk') | bookmarks(exact:'main') | bookmarks(exact:'master')) | bookmarks(exact:'default')"

[fix.tools.rustfmt]
command = ["rustfmt", "+nightly", "--emit", "stdout"]
patterns = ["glob:'**/*.rs'"]
