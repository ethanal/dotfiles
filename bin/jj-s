#!/usr/bin/env bash

set -euo pipefail

if [[ $# -eq 0 ]]; then
  REVSET="@"
else
  REVSET="$1"
fi

preview_cmd="jj diff --color=always -r $REVSET {1} --git | delta --side-by-side --minus-style \"syntax #500000\" --plus-style \"syntax #005000\" -w 200"

jj show $REVSET -T 'description.first_line() ++ "\n"' --name-only | \
  fzf --ansi --tac --preview "$preview_cmd" --preview-window "right,80%" --header-lines 1 > /dev/null
